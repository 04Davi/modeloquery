@page
@model Database.Pages.CreateRelationshipModel
@{
    ViewData["Title"] = "Crear Relación";
}

<div class="modal">
   <div class="modal">
    <div class="modal-header">
        <h2>Crear Relación</h2>
        <button type="button" class="close-btn" onclick="window.location.href='/Dashboard'">×</button>
    </div>

    <form method="post">
        <div class="modal-body">
            <label>Tabla Principal</label>
            <select asp-for="Table1" asp-items="new SelectList(Model.AvailableTables)" class="input" onchange="this.form.submit()" required></select>

            <label>Tabla Relacionada</label>
            <select asp-for="Table2" asp-items="new SelectList(Model.AvailableTables.Where(t => t != Model.Table1))" class="input" onchange="this.form.submit()" required></select>

            <label>Tipo de Relación</label>
            <select asp-for="RelationshipType" class="input" required>
                <option value="OneToOne">Uno a Uno</option>
                <option value="OneToMany">Uno a Muchos</option>
                <option value="ManyToMany">Muchos a Muchos</option>
            </select>

            @if (!string.IsNullOrEmpty(Model.Table1) && !string.IsNullOrEmpty(Model.Table2))
            {
                <label>Columna de @Model.Table1</label>
                <select asp-for="Column1" asp-items="new SelectList(Model.ColumnsTable1)" class="input" required></select>

                <label>Columna de @Model.Table2</label>
                <select asp-for="Column2" asp-items="new SelectList(Model.ColumnsTable2)" class="input" required></select>
            }

            <button type="submit" class="create-btn">Crear Relación</button>
        </div>
    </form>

    @if (!string.IsNullOrEmpty(Model.SqlResult))
    {
        <div class="sql-result">
            <pre>@Model.SqlResult</pre>
        </div>
    }
</div>

<style>
    .modal { max-width: 800px; margin: 2rem auto; background: #fff; border-radius: 10px; padding: 1.5rem; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); }
    .modal-header { display: flex; justify-content: space-between; align-items: center; }
    .modal-body label { display: block; margin-top: 1rem; font-weight: bold; }
    .input { width: 100%; padding: 0.5rem; margin-top: 0.5rem; border: 1px solid #ccc; border-radius: 6px; }
    .create-btn { margin-top: 1rem; padding: 0.5rem 1rem; background: #6200ea; color: #fff; border: none; border-radius: 6px; cursor: pointer; }
    .sql-result { margin-top: 1rem; background: #f5f5f5; padding: 1rem; border-radius: 6px; font-family: monospace; white-space: pre-wrap; }
</style>